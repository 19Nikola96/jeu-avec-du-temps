{"ast":null,"code":"import _slicedToArray from\"/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import Game1 from'./Game1';import'./Style/startGame.css';import WaitingAnim from'./WaitingAnim';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StartGame=function StartGame(_ref){var idRoom=_ref.idRoom,socketRef=_ref.socketRef;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),startGamePreview=_useState2[0],setStartGamePreview=_useState2[1];var yourPlayingRef=useRef(false);// DISPLAY\nvar _useState3=useState(),_useState4=_slicedToArray(_useState3,2),actualTeam=_useState4[0],setActualTeam=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),actualPlayer=_useState6[0],setActualPlayer=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),actualPlayerId=_useState8[0],setActualPlayerId=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),teams=_useState10[0],setTeams=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),teamPlayers=_useState12[0],setTeamPlayers=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),users=_useState14[0],setUsers=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),round=_useState16[0],setRound=_useState16[1];useEffect(function(){socketRef.current.emit(\"ask teams\",idRoom);socketRef.current.on(\"teams\",function(teams){yourPlayingRef.current=false;teams.forEach(function(team){if(team.playing===true){setActualTeam(team.name);team.players.forEach(function(player){if(player.playing===true){if(player.id===socketRef.current.id){yourPlayingRef.current=true;}setActualPlayer(player.pseudo);setActualPlayerId(player.id);}});}});});socketRef.current.on(\"start game now\",function(start){setStartGamePreview(start);});socketRef.current.emit(\"ask rules\",idRoom);socketRef.current.on(\"rules\",function(rulesData){setRound(rulesData.round);});},[]);var startGame=function startGame(){socketRef.current.emit(\"start game\",idRoom);setStartGamePreview(true);};return/*#__PURE__*/_jsx(_Fragment,{children:startGamePreview?/*#__PURE__*/_jsx(Game1,{socketRef:socketRef,idRoom:idRoom}):/*#__PURE__*/_jsx(\"div\",{className:\"transition-game\",children:yourPlayingRef.current===true?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h5\",{children:\"C'est \\xE0 toi de jouer !\"}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column justify-content-center align-items-center\",style:{height:'63vh'},children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return startGame();},className:\"start-bouton\",children:\"Let's Go\"})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column justify-content-center align-items-center\",style:{height:'75vh'},children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Prochain joueur\"}),/*#__PURE__*/_jsx(\"div\",{className:\"player-name\",children:actualPlayer}),/*#__PURE__*/_jsx(WaitingAnim,{})]})})});};export default StartGame;","map":{"version":3,"sources":["/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/src/Components/StartGame.tsx"],"names":["React","useEffect","useRef","useState","Game1","WaitingAnim","StartGame","idRoom","socketRef","startGamePreview","setStartGamePreview","yourPlayingRef","actualTeam","setActualTeam","actualPlayer","setActualPlayer","actualPlayerId","setActualPlayerId","teams","setTeams","teamPlayers","setTeamPlayers","users","setUsers","round","setRound","current","emit","on","forEach","team","playing","name","players","player","id","pseudo","start","rulesData","startGame","height"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport { AdminObj, RulesObj, TeamObj } from '../Types';\nimport Game1 from './Game1';\nimport './Style/startGame.css';\nimport WaitingAnim from './WaitingAnim';\n\ntype Props = {\n    idRoom: string | number\n    socketRef: React.MutableRefObject<any>\n}\n\ntype TeamPlayers = {\n    id: string | number | undefined\n    pseudo: string | null | undefined\n}\n\nconst StartGame: React.FC<Props> = ({ idRoom, socketRef }) => {\n\n    const [startGamePreview, setStartGamePreview] = useState<boolean>(false)\n    const yourPlayingRef: React.MutableRefObject<boolean | undefined> = useRef(false)\n    // DISPLAY\n\n    const [actualTeam, setActualTeam] = useState<string>()\n    const [actualPlayer, setActualPlayer] = useState<string | null | undefined>()\n    const [actualPlayerId, setActualPlayerId] = useState<string | number | undefined>()\n\n    const [teams, setTeams] = useState<TeamObj[]>()\n    const [teamPlayers, setTeamPlayers] = useState<TeamPlayers []>([])\n\n    const [users, setUsers] = useState<AdminObj[]>()\n\n    const [round, setRound] = useState<number>(0)\n\n    useEffect(() => {\n        socketRef.current.emit(\"ask teams\", idRoom);\n        socketRef.current.on(\"teams\", (teams: TeamObj []) => {\n            yourPlayingRef.current = false\n            \n            teams.forEach((team) => {\n                if (team.playing === true) {                    \n                    setActualTeam(team.name)\n                    team.players.forEach((player) => {\n                        if (player.playing === true) {\n                            if (player.id === socketRef.current.id) {                                                    \n                                yourPlayingRef.current = true\n                            }  \n                            setActualPlayer(player.pseudo)\n                            setActualPlayerId(player.id)\n                        }\n                    })\n                }\n            })\n        });\n\n        socketRef.current.on(\"start game now\", (start: boolean) => {\n            setStartGamePreview(start)\n        })\n\n        socketRef.current.emit(\"ask rules\", idRoom)\n        socketRef.current.on(\"rules\", (rulesData: RulesObj) => {\n            setRound(rulesData.round)\n        })\n    }, [])\n\n    const startGame = () => {\n        socketRef.current.emit(\"start game\", idRoom)\n        setStartGamePreview(true)\n    }\n\n    return (\n        <>                    \n            { startGamePreview\n                ? <Game1 socketRef={socketRef} idRoom={idRoom} />\n\n                : <div className=\"transition-game\">\n                    { yourPlayingRef.current === true\n                        ? <>\n                            <h5>C'est Ã  toi de jouer !</h5>\n                            <div className=\"d-flex flex-column justify-content-center align-items-center\" style={{height: '63vh'}}>                            \n                                <button onClick={() => startGame()} className=\"start-bouton\">Let's Go</button>\n                            </div> \n                        </>\n\n                        : <div className=\"d-flex flex-column justify-content-center align-items-center\" style={{height: '75vh'}}>\n                            <h5>Prochain joueur</h5>\n                            <div className=\"player-name\">{actualPlayer}</div>\n                            <WaitingAnim />\n                          </div>                        \n                    }     \n                </div>      \n            }            \n        </>\n    )\n}\n\nexport default StartGame\n"]},"metadata":{},"sourceType":"module"}