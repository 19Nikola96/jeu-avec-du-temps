{"ast":null,"code":"import _slicedToArray from\"/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import ReactScrollableFeed from'react-scrollable-feed';import'./Style/messenger.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Messenger=function Messenger(_ref){var idRoom=_ref.idRoom,socketRef=_ref.socketRef;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),myPseudo=_useState2[0],setMyPseudo=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),myId=_useState4[0],setMyId=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];useEffect(function(){setMyId(socketRef.current.id);socketRef.current.on(\"messages\",function(messageBody){setMessages(messageBody);});setMyPseudo(localStorage.getItem('myPseudo'));},[messages]);var sendMessage=function sendMessage(e){e.preventDefault();if(message!==''){var messageObject={body:{message:message,myPseudo:myPseudo,id:myId},idRoom:idRoom};setMessage('');socketRef.current.emit(\"send message\",messageObject);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-7 messenger slide\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mt-2\",children:\"Messages\"}),/*#__PURE__*/_jsx(\"ul\",{id:\"messages\",children:/*#__PURE__*/_jsx(ReactScrollableFeed,{children:messages!==undefined?/*#__PURE__*/_jsx(_Fragment,{children:messages.map(function(messageBody,index){if(messageBody.id===myId){return/*#__PURE__*/_jsx(\"div\",{className:\"new-message row justify-content-end\",children:/*#__PURE__*/_jsx(\"li\",{className:\"your-message text-end my-2 mr-4 px-3\",children:/*#__PURE__*/_jsx(\"p\",{className:\"mt-2\",children:messageBody.message})})},index);}else{return/*#__PURE__*/_jsx(\"div\",{className:\"new-message row justify-content-start\",children:/*#__PURE__*/_jsx(\"li\",{className:\"others-message text-start my-2 mr-4 px-3\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{children:messageBody.myPseudo}),\" - \",messageBody.message]})})},index);}})}):''})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:sendMessage,className:\"message-form row justify-content-between\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"send-input\",placeholder:\"\\xC9crit un truc...\",value:message,onChange:function onChange(e){return setMessage(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"mon-bouton rounded-circle\",type:\"submit\",style:{filter:'hue-rotate(18deg)'},children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-paper-plane\"})})]})]});};export default Messenger;","map":{"version":3,"sources":["/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/src/Components/Messenger.tsx"],"names":["React","useEffect","useState","ReactScrollableFeed","Messenger","idRoom","socketRef","myPseudo","setMyPseudo","myId","setMyId","message","setMessage","messages","setMessages","current","id","on","messageBody","localStorage","getItem","sendMessage","e","preventDefault","messageObject","body","emit","undefined","map","index","target","value","filter"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { BodyMessageObject } from '../Types'\nimport ReactScrollableFeed from 'react-scrollable-feed'\nimport './Style/messenger.css';\n\ntype Props = {\n    idRoom: string | number\n    socketRef: React.MutableRefObject<any>\n}\n\nconst Messenger: React.FC<Props> = ({ idRoom, socketRef }) => {\n\n    const [myPseudo, setMyPseudo] = useState<string | null>('')\n    const [myId, setMyId] = useState<string | number>()\n    const [message, setMessage] = useState<string>('')\n    const [messages, setMessages] = useState<BodyMessageObject []>([])\n\n    useEffect(() => {\n        setMyId(socketRef.current.id)\n\n        socketRef.current.on(\"messages\", (messageBody: BodyMessageObject[]) => {                             \n            setMessages(messageBody)\n        })\n\n        setMyPseudo(localStorage.getItem('myPseudo'))\n    }, [messages])\n\n    const sendMessage = (e: React.ChangeEvent<HTMLFormElement>) => {\n        e.preventDefault()\n        if (message !== '') {\n            const messageObject = {\n                body: { \n                    message,\n                    myPseudo,\n                    id: myId\n                }, \n                idRoom\n            }\n            setMessage('')            \n            socketRef.current.emit(\"send message\", messageObject)\n        }\n    }\n\n    return (\n        <div className=\"col-md-7 messenger slide\">\n            <h3 className=\"mt-2\">Messages</h3>\n            <ul id=\"messages\">\n            <ReactScrollableFeed>\n                { messages !== undefined\n                    ? <>\n                        {messages.map((messageBody, index) => {                                                   \n                            if (messageBody.id === myId) {\n                            return <div key={index} className=\"new-message row justify-content-end\">\n                                    <li className=\"your-message text-end my-2 mr-4 px-3\">\n                                        <p className=\"mt-2\">{messageBody.message}</p>                            \n                                    </li>\n                                </div> \n                            } else {\n                            return <div key={index} className=\"new-message row justify-content-start\">\n                                    <li className=\"others-message text-start my-2 mr-4 px-3\">\n                                        <p className=\"mt-2\"> <span>{messageBody.myPseudo}</span> - {messageBody.message}</p>                            \n                                    </li>\n                                </div> \n                            }\n                            \n                })}\n                    </>\n\n                    : ''\n                }\n            </ReactScrollableFeed>\n            \n            </ul>\n            <form onSubmit={sendMessage} className=\"message-form row justify-content-between\">\n                <input className=\"send-input\" placeholder=\"Ã‰crit un truc...\" value={message} onChange={(e) => setMessage(e.target.value)} />\n                <button className=\"mon-bouton rounded-circle\" type=\"submit\" style={{ filter: 'hue-rotate(18deg)'}}><i className=\"fas fa-paper-plane\"></i></button>\n            </form>\n        </div>\n    )\n}\n\nexport default Messenger\n"]},"metadata":{},"sourceType":"module"}