{"ast":null,"code":"import _toConsumableArray from\"/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import CreateTeams from'./CreateTeams';import Messenger from'./Messenger';import StartGameTransition from'./StartGame';import'./Style/room.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Room=function Room(_ref){var roomData=_ref.roomData,error=_ref.error,socketRef=_ref.socketRef;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),displayAddWord=_useState2[0],setDisplayAddWord=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),displaySetWordsSize=_useState4[0],setDisplaySetWordsSize=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),displayCreateTeam=_useState6[0],setDisplayCreateTeam=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),displayStartGame=_useState8[0],setDisplayStartGame=_useState8[1];// DISPLAY //\nvar _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),word=_useState10[0],setWord=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),words=_useState12[0],setWords=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),wordsLength=_useState14[0],setWordsLength=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),allWords=_useState16[0],setAllWords=_useState16[1];// WORDS //\nvar _useState17=useState(5),_useState18=_slicedToArray(_useState17,2),nbrWords=_useState18[0],setNbrWords=_useState18[1];var _useState19=useState(45),_useState20=_slicedToArray(_useState19,2),time=_useState20[0],setTime=_useState20[1];var _useState21=useState(90),_useState22=_slicedToArray(_useState21,2),drawTime=_useState22[0],setDrawTime=_useState22[1];var _useState23=useState(),_useState24=_slicedToArray(_useState23,2),rules=_useState24[0],setRules=_useState24[1];var _useState25=useState(),_useState26=_slicedToArray(_useState25,2),round=_useState26[0],setRound=_useState26[1];// RULES //\nvar _useState27=useState(),_useState28=_slicedToArray(_useState27,2),users=_useState28[0],setUsers=_useState28[1];// USERS //\nvar inputRef=React.useRef();useEffect(function(){socketRef.current.emit(\"ask share rooms\",true);socketRef.current.emit(\"ask rules\",roomData.id);socketRef.current.on(\"start game prvw\",function(start){setDisplayStartGame(start);});socketRef.current.on(\"share rooms\",function(data){if(roomData.id!==''){Object.keys(data).map(function(id){if(roomData.id===id){setUsers(data[id].users);}return true;});}});socketRef.current.on(\"words\",function(words){setAllWords(words);setWordsLength(words.length);});socketRef.current.on(\"rules\",function(rulesData){setRules(rulesData);// Display \"Rules have been updated\"\n});},[roomData]);var copyLink=function copyLink(e){inputRef.current.select();document.execCommand('copy');e.target.focus();};var handleAddWord=function handleAddWord(e){e.preventDefault();if(word.length!==0){if((rules===null||rules===void 0?void 0:rules.numberOfWords)===null&&words.length>2){words.splice(words.length,1);setWord('');window.alert('Tu ne peux plus ajouter de mots pour le moment ! Il fau attendre que l\\' admin de la room mette en place les régles');}else{console.log(words.length,'>',rules===null||rules===void 0?void 0:rules.numberOfWords);if(rules&&(rules===null||rules===void 0?void 0:rules.numberOfWords)!==null&&words.length>(rules===null||rules===void 0?void 0:rules.numberOfWords)-1){console.log('test');setWord('');window.alert('Tu ne peux plus ajouter de mots');}else{setWords([].concat(_toConsumableArray(words),[word]));var wordData={word:word,idRoom:roomData.id};socketRef.current.emit(\"add word\",wordData);setWord('');}}}};var handleRulesSet=function handleRulesSet(e){e.preventDefault();var rulesData={numberOfWords:nbrWords,time:time,timeDraw:drawTime,round:2,idRoom:roomData.id};socketRef.current.emit(\"set rules\",rulesData);setDisplaySetWordsSize(!displaySetWordsSize);};var startGamePreview=function startGamePreview(){socketRef.current.emit(\"start game preview\",roomData.id);// socketRef.current.emit(\"set playing team and player\", roomData.id)\nsetDisplayStartGame(true);};return/*#__PURE__*/_jsx(_Fragment,{children:displayStartGame?/*#__PURE__*/_jsx(StartGameTransition,{socketRef:socketRef,idRoom:roomData.id}):/*#__PURE__*/_jsxs(\"div\",{className:\"room container grow\",children:[error,/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column justify-content-between align-items-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-3\",children:roomData===undefined?'':roomData.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"ID Room\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"mx-auto copy-input\",ref:inputRef,type:\"text\",defaultValue:roomData===undefined?'':roomData.id}),/*#__PURE__*/_jsx(\"button\",{className:\"mon-bouton mx-2 mb-3 rounded\",onClick:function onClick(e){return copyLink(e);},style:{filter:'hue-rotate(18deg)'},children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-clone\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-auto\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"room-bouton\",onClick:function onClick(){return setDisplaySetWordsSize(!displaySetWordsSize);},type:\"button\",children:[\"R\\xE9gles \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-caret-down\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"position-dropdown\",children:roomData.admin.id===socketRef.current.id?/*#__PURE__*/_jsx(_Fragment,{children:displaySetWordsSize?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleRulesSet,className:\"dropdowned-item d-flex flex-column dropdown-unfold\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-start\",children:\"Nombre de mots/joueurs\"}),/*#__PURE__*/_jsx(\"input\",{value:nbrWords,className:\"w-25\",onChange:function onChange(e){return setNbrWords(parseFloat(e.target.value));},type:\"number\",min:\"3\",max:\"1000\"}),/*#__PURE__*/_jsx(\"label\",{className:\"text-start mt-2\",children:\"Temps Round 1 et 2\"}),/*#__PURE__*/_jsx(\"input\",{value:time,className:\"w-25\",onChange:function onChange(e){return setTime(parseFloat(e.target.value));},type:\"number\",min:\"5\",max:\"1000\"}),/*#__PURE__*/_jsx(\"label\",{className:\"text-start mt-2\",children:\"Temps Round 3\"}),/*#__PURE__*/_jsx(\"input\",{value:drawTime,className:\"w-25\",onChange:function onChange(e){return setDrawTime(parseFloat(e.target.value));},type:\"number\",min:\"30\",max:\"1000\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-end\",children:/*#__PURE__*/_jsx(\"button\",{className:\"orange-button\",type:\"submit\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check\"})})})]}):''}):/*#__PURE__*/_jsx(_Fragment,{children:displaySetWordsSize?/*#__PURE__*/_jsxs(\"div\",{className:\"dropdowned-item d-flex flex-column dropdown-unfold\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Nombre de mots/joueurs\"}),/*#__PURE__*/_jsx(\"p\",{children:(rules===null||rules===void 0?void 0:rules.numberOfWords)===null?\"5\":rules===null||rules===void 0?void 0:rules.numberOfWords}),/*#__PURE__*/_jsx(\"span\",{children:\"Temps round 1 et 2\"}),/*#__PURE__*/_jsx(\"p\",{children:(rules===null||rules===void 0?void 0:rules.numberOfWords)===null?\"45\":rules===null||rules===void 0?void 0:rules.time}),/*#__PURE__*/_jsx(\"span\",{children:\"Temps round 3\"}),/*#__PURE__*/_jsx(\"p\",{children:(rules===null||rules===void 0?void 0:rules.numberOfWords)===null?\"90\":rules===null||rules===void 0?void 0:rules.timeDraw})]}):''})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-auto\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"room-bouton\",onClick:function onClick(){return setDisplayAddWord(!displayAddWord);},type:\"button\",children:[\"Ajouter un mot \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-caret-down\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"position-dropdown\",children:displayAddWord?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddWord,className:\"dropdowned-item row dropdown-unfold justify-content-between\",children:[/*#__PURE__*/_jsx(\"input\",{value:word,onChange:function onChange(e){return setWord(e.target.value);},className:\"w-75 mr-3\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{className:\"orange-button\",type:\"submit\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check\"})})]}):''})]}),roomData.admin.id===socketRef.current.id?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"room-bouton me-1\",onClick:function onClick(){return setDisplayCreateTeam(!displayCreateTeam);},children:displayCreateTeam?'Voir Messages':'Créer Équipes'}),/*#__PURE__*/_jsx(\"button\",{className:\"room-bouton ms-1\",onClick:function onClick(){return startGamePreview();},children:\"Test Round\"})]}):'',displayCreateTeam?/*#__PURE__*/_jsx(\"div\",{className:\"team-position\",children:/*#__PURE__*/_jsx(CreateTeams,{idRoom:roomData.id,socketRef:socketRef})}):'']})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row mt-3 justify-content-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-4 users\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-between\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"word-count-all\",children:[wordsLength,\"/\",rules&&users&&(users===null||users===void 0?void 0:users.length)>3?(rules===null||rules===void 0?void 0:rules.numberOfWords)*(users===null||users===void 0?void 0:users.length):\"20\"]}),/*#__PURE__*/_jsx(\"h3\",{className:\"mt-2\",children:\"Joueurs\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"word-count-perso\",children:[words.length,\"/\",rules&&rules.numberOfWords!==null?rules.numberOfWords:\"3\"]})]}),/*#__PURE__*/_jsx(\"ul\",{children:users!==undefined?users.map(function(user,index){if(roomData.admin.id===user.id){return/*#__PURE__*/_jsx(\"li\",{className:\"grow\",children:/*#__PURE__*/_jsxs(\"p\",{children:[user.pseudo,\" \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-star\"})]})},index);}else{return/*#__PURE__*/_jsx(\"li\",{className:\"grow\",children:/*#__PURE__*/_jsx(\"p\",{children:user.pseudo})},index);}}):''})]}),/*#__PURE__*/_jsx(Messenger,{idRoom:roomData.id,socketRef:socketRef})]})})]})]})});};export default Room;","map":{"version":3,"sources":["/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/src/Components/Room.tsx"],"names":["React","useEffect","useState","CreateTeams","Messenger","StartGameTransition","Room","roomData","error","socketRef","displayAddWord","setDisplayAddWord","displaySetWordsSize","setDisplaySetWordsSize","displayCreateTeam","setDisplayCreateTeam","displayStartGame","setDisplayStartGame","word","setWord","words","setWords","wordsLength","setWordsLength","allWords","setAllWords","nbrWords","setNbrWords","time","setTime","drawTime","setDrawTime","rules","setRules","round","setRound","users","setUsers","inputRef","useRef","current","emit","id","on","start","data","Object","keys","map","length","rulesData","copyLink","e","select","document","execCommand","target","focus","handleAddWord","preventDefault","numberOfWords","splice","window","alert","console","log","wordData","idRoom","handleRulesSet","timeDraw","startGamePreview","undefined","name","filter","admin","parseFloat","value","user","index","pseudo"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { AdminObj, DataRoomObjWithKey, RoomObj, RulesObj } from '../Types'\nimport CreateTeams from './CreateTeams';\nimport Messenger from './Messenger'\nimport StartGameTransition from './StartGame';\nimport './Style/room.css';\n\ntype Props = {\n    roomData: RoomObj\n    error: string\n    socketRef: React.MutableRefObject<any>\n}\n\nconst Room: React.FC<Props> = ({ roomData, error, socketRef }) => {\n\n    const [displayAddWord, setDisplayAddWord] = useState<boolean>(false)\n    const [displaySetWordsSize, setDisplaySetWordsSize] = useState<boolean>(false)\n    const [displayCreateTeam, setDisplayCreateTeam] = useState<boolean>(false)\n\n    const [displayStartGame, setDisplayStartGame] = useState<boolean>(false)\n    // DISPLAY //\n\n\n    const [word, setWord] = useState<string>('')\n    const [words, setWords] = useState<string []>([])\n    const [wordsLength, setWordsLength] = useState<number>(0)\n    const [allWords, setAllWords] = useState<string []>([])\n    // WORDS //\n\n    const [nbrWords, setNbrWords] = useState<number>(5)\n    const [time, setTime] = useState<number>(45)\n    const [drawTime, setDrawTime] = useState<number>(90)\n    const [rules, setRules] = useState<RulesObj>()\n    const [round, setRound] = useState<number>()\n    // RULES //\n\n    const [users, setUsers] = useState<AdminObj[]>()\n    // USERS //\n\n    const inputRef = React.useRef() as React.MutableRefObject<HTMLInputElement>;\n\n    useEffect(() => {\n        socketRef.current.emit(\"ask share rooms\", true)\n        socketRef.current.emit(\"ask rules\", roomData.id)\n\n        socketRef.current.on(\"start game prvw\", (start: boolean) => {\n            setDisplayStartGame(start)\n        })\n\n        socketRef.current.on(\"share rooms\", (data: DataRoomObjWithKey) => {                        \n            if (roomData.id !== '') {\n                Object.keys(data).map((id) => {                    \n                    if (roomData.id === id) {\n                        setUsers(data[id].users)            \n                    }\n                    return true\n                })\n            }\n        })\n\n        socketRef.current.on(\"words\", (words: string []) => {\n            setAllWords(words)\n            \n            setWordsLength(words.length);\n        })\n\n        socketRef.current.on(\"rules\", (rulesData: RulesObj) => {\n            setRules(rulesData);\n            // Display \"Rules have been updated\"\n        })\n\n    }, [roomData])\n\n\n    const copyLink = (e: any) => {\n        inputRef.current.select();\n\n        document.execCommand('copy');\n\n        e.target.focus();\n    }\n    \n    const handleAddWord = (e: React.ChangeEvent<HTMLFormElement>) => {\n        e.preventDefault()\n\n        if (word.length !== 0) {\n            if (rules?.numberOfWords === null && words.length > 2 ) {\n                words.splice(words.length ,1)\n                setWord('')\n                window.alert('Tu ne peux plus ajouter de mots pour le moment ! Il fau attendre que l\\' admin de la room mette en place les régles')                \n            } else {\n                console.log(words.length, '>', rules?.numberOfWords);\n                \n                if (rules && rules?.numberOfWords !== null && words.length > rules?.numberOfWords - 1) {\n                    console.log('test');\n                    \n                    setWord('')\n                    window.alert('Tu ne peux plus ajouter de mots')\n                } else {                    \n                    setWords([...words, word])\n    \n                    const wordData = {\n                        word: word,\n                        idRoom: roomData.id\n                    }\n    \n                    socketRef.current.emit(\"add word\", wordData)\n                    setWord('')\n                }\n            }\n        }\n    }\n\n    const handleRulesSet = (e: React.ChangeEvent<HTMLFormElement>) => {\n        e.preventDefault()        \n\n        const rulesData = {\n            numberOfWords: nbrWords,\n            time: time,\n            timeDraw: drawTime,\n            round: 2,\n            idRoom: roomData.id,\n        }\n\n        socketRef.current.emit(\"set rules\", rulesData)\n\n        setDisplaySetWordsSize(!displaySetWordsSize)\n    }\n\n    const startGamePreview = () => {\n        socketRef.current.emit(\"start game preview\", roomData.id)\n\n        // socketRef.current.emit(\"set playing team and player\", roomData.id)\n\n        setDisplayStartGame(true)\n    }\n\n    return (\n        <>\n            { displayStartGame\n                ? <StartGameTransition socketRef={socketRef} idRoom={roomData.id}/>\n\n                :  <div className=\"room container grow\">\n                    {error}\n                    <div className=\"d-flex flex-column justify-content-between align-items-between\">\n                        <div>\n                            <h2 className=\"mb-3\">{roomData === undefined ? '' : roomData.name}</h2>\n                            <div className=\"row\">\n                                <label>ID Room</label>\n                                <div>\n                                    <input className=\"mx-auto copy-input\" ref={inputRef} type=\"text\" defaultValue={roomData === undefined ? '' : roomData.id}/>\n                                    <button className=\"mon-bouton mx-2 mb-3 rounded\" onClick={(e) => copyLink(e)} style={{ filter: 'hue-rotate(18deg)'}}><i className=\"fas fa-clone\"></i></button>\n                                </div>                                \n                                <div className=\"row justify-content-between\">\n                                    <div className=\"w-auto\">\n                                        <button className=\"room-bouton\" onClick={() => setDisplaySetWordsSize(!displaySetWordsSize)} type=\"button\">\n                                            Régles <i className=\"fas fa-caret-down\"></i>\n                                        </button>\n                                        <div className=\"position-dropdown\">\n                                            { roomData.admin.id === socketRef.current.id\n                                                ? <> \n                                                    { displaySetWordsSize \n                                                        ? <form onSubmit={handleRulesSet} className=\"dropdowned-item d-flex flex-column dropdown-unfold\">\n                                                            <label className=\"text-start\">Nombre de mots/joueurs</label>\n                                                            <input value={nbrWords} \n                                                                className=\"w-25\"\n                                                                onChange={(e) => setNbrWords(parseFloat(e.target.value))} \n                                                                type=\"number\"\n                                                                min=\"3\"\n                                                                max=\"1000\"       \n                                                            />\n                                                            <label className=\"text-start mt-2\">Temps Round 1 et 2</label>\n                                                            <input value={time} \n                                                                className=\"w-25\"\n                                                                onChange={(e) => setTime(parseFloat(e.target.value))} \n                                                                type=\"number\"\n                                                                min=\"5\"\n                                                                max=\"1000\"       \n                                                            />\n                                                            <label className=\"text-start mt-2\">Temps Round 3</label>\n                                                            <input value={drawTime} \n                                                                className=\"w-25\"\n                                                                onChange={(e) => setDrawTime(parseFloat(e.target.value))} \n                                                                type=\"number\"\n                                                                min=\"30\"\n                                                                max=\"1000\"       \n                                                            />   \n                                                            <div className=\"text-end\">\n                                                                <button className=\"orange-button\" type=\"submit\"><i className=\"fas fa-check\"></i></button>\n                                                            </div>\n                                                          </form>\n                                                        \n                                                        : ''\n                                                    }\n                                                </>\n                                            \n                                                : <>\n                                                    { displaySetWordsSize \n                                                        ? <div className=\"dropdowned-item d-flex flex-column dropdown-unfold\">\n                                                            <span>Nombre de mots/joueurs</span>\n                                                            <p>{ rules?.numberOfWords === null ? \"5\" : rules?.numberOfWords }</p>\n                                                            <span>Temps round 1 et 2</span>\n                                                            <p>{ rules?.numberOfWords === null ? \"45\" : rules?.time }</p>\n                                                            <span>Temps round 3</span>\n                                                            <p>{ rules?.numberOfWords === null ? \"90\" : rules?.timeDraw }</p>                                               \n                                                        </div>\n    \n                                                        : ''\n                                                    }\n                                                </>\n                                            }                                    \n                                        </div>\n                                    </div>\n                                    <div className=\"w-auto\">\n                                        <button className=\"room-bouton\" onClick={() => setDisplayAddWord(!displayAddWord)} type=\"button\">\n                                            Ajouter un mot <i className=\"fas fa-caret-down\"></i>\n                                        </button>\n                                        <div className=\"position-dropdown\">\n                                            { displayAddWord \n                                                ? <form onSubmit={handleAddWord} className=\"dropdowned-item row dropdown-unfold justify-content-between\">\n                                                    <input value={word} onChange={(e) => setWord(e.target.value)} className=\"w-75 mr-3\" type=\"text\"/>\n                                                    <button className=\"orange-button\" type=\"submit\"><i className=\"fas fa-check\"></i></button>\n                                                </form>\n        \n                                                : ''\n                                            }\n                                        </div>\n                                    </div>\n                                    { roomData.admin.id === socketRef.current.id \n                                        ? <div>\n                                            <button className=\"room-bouton me-1\" onClick={() => setDisplayCreateTeam(!displayCreateTeam)}>{displayCreateTeam ? 'Voir Messages' : 'Créer Équipes'}</button>\n                                            <button className=\"room-bouton ms-1\" onClick={() => startGamePreview()}>Test Round</button>\n                                        </div>\n\n                                        : ''\n                                    }\n                                    { displayCreateTeam\n                                    ? <div className=\"team-position\">\n                                        <CreateTeams idRoom={roomData.id} socketRef={socketRef} />\n                                    </div> \n                                \n                                    : ''                    \n                                }  \n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"container\">\n                            <div className=\"row mt-3 justify-content-between\">\n                                <div className=\"col-md-4 users\">\n                                    <div className=\"row justify-content-between\">\n                                        <p className=\"word-count-all\">{wordsLength}/{rules && users && users?.length > 3 ? rules?.numberOfWords * users?.length : \"20\"}</p>\n                                        <h3 className=\"mt-2\">Joueurs</h3>\n                                        <p className=\"word-count-perso\">{words.length}/{rules && rules.numberOfWords !== null ? rules.numberOfWords : \"3\"}</p>\n                                    </div>\n                                    <ul>\n                                        { users !== undefined\n                                            ? users.map((user, index) => {\n                                                if (roomData.admin.id === user.id) {\n                                                    return <li key={index} className=\"grow\">\n                                                                <p>{user.pseudo} <i className=\"fas fa-star\"></i></p>\n                                                        </li>\n                                                } else {                                        \n                                                    return <li key={index} className=\"grow\">\n                                                                <p>{user.pseudo}</p>\n                                                        </li>\n                                                }\n                                            })\n        \n                                            : ''\n                                        }\n                                    </ul>\n                                </div>\n                                <Messenger idRoom={roomData.id} socketRef={socketRef} />                              \n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n            }\n        </>\n    )\n}\n\nexport default Room\n"]},"metadata":{},"sourceType":"module"}