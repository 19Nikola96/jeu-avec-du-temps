{"ast":null,"code":"import _slicedToArray from\"/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import StartGame from'./StartGame';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NextRound=function NextRound(_ref){var idRoom=_ref.idRoom,socketRef=_ref.socketRef;var yourPlayingRef=useRef(false);var _useState=useState(),_useState2=_slicedToArray(_useState,2),teams=_useState2[0],setTeams=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),round=_useState4[0],setRound=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),displayStartGame=_useState6[0],setDisplayStartGame=_useState6[1];useEffect(function(){socketRef.current.on(\"start game prvw\",function(start){setDisplayStartGame(start);});socketRef.current.emit(\"ask rules\",idRoom);socketRef.current.on(\"rules\",function(rulesData){setRound(rulesData.round);});socketRef.current.emit(\"ask teams\",idRoom);socketRef.current.on(\"teams\",function(teams){setTeams(teams);teams.forEach(function(team){if(team.playing===true){team.players.forEach(function(player){if(player.playing===true){if(player.id===socketRef.current.id){yourPlayingRef.current=true;}}});}});});},[]);var startNextRound=function startNextRound(){socketRef.current.emit(\"start game preview\",idRoom);socketRef.current.emit(\"set playing team and player\",idRoom);setDisplayStartGame(true);};return/*#__PURE__*/_jsx(_Fragment,{children:displayStartGame?/*#__PURE__*/_jsx(StartGame,{socketRef:socketRef,idRoom:idRoom}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[\"Phase \",round,\" fini !\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-between mx-auto\",style:{width:'80%'},children:teams===null||teams===void 0?void 0:teams.map(function(team,index){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"team-results col-md-3 grow\",children:[/*#__PURE__*/_jsx(\"h4\",{children:team.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\" \",team.points,\" \",team.points<=1?'point':'points']})]})});})}),yourPlayingRef.current===true?/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return startNextRound();},className:\"mon-bouton mx-auto\",children:\"Phase suivante !\"}):'']})});};export default NextRound;","map":{"version":3,"sources":["/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/src/Components/NextRound.tsx"],"names":["React","useEffect","useRef","useState","StartGame","NextRound","idRoom","socketRef","yourPlayingRef","teams","setTeams","round","setRound","displayStartGame","setDisplayStartGame","current","on","start","emit","rulesData","forEach","team","playing","players","player","id","startNextRound","width","map","index","name","points"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport { RulesObj, TeamObj } from '../Types'\nimport StartGame from './StartGame'\n\ntype Props = {\n    idRoom: string | number\n    socketRef: React.MutableRefObject<any>\n}\n\nconst NextRound: React.FC<Props> = ({ idRoom, socketRef }) => {\n\n    const yourPlayingRef: React.MutableRefObject<boolean | undefined> = useRef(false)\n\n    const [teams, setTeams] = useState<TeamObj []>()\n    const [round, setRound] = useState<number>(0)\n    const [displayStartGame, setDisplayStartGame] = useState(false)\n\n    useEffect(() => {\n        socketRef.current.on(\"start game prvw\", (start: boolean) => {\n            setDisplayStartGame(start)\n        })\n\n        socketRef.current.emit(\"ask rules\", idRoom)\n        socketRef.current.on(\"rules\", (rulesData: RulesObj) => {\n            setRound(rulesData.round)\n        })\n\n        socketRef.current.emit(\"ask teams\", idRoom);\n        socketRef.current.on(\"teams\", (teams: TeamObj []) => {   \n            setTeams(teams)\n            \n            teams.forEach((team) => {\n                if (team.playing === true) {                    \n                    team.players.forEach((player) => {\n                        if (player.playing === true) {\n                            if (player.id === socketRef.current.id) {                    \n                                yourPlayingRef.current = true\n                            }  \n                        }                        \n                    })\n                }\n            })\n        });\n    }, [])\n\n    const startNextRound = () => {\n        socketRef.current.emit(\"start game preview\", idRoom)        \n\n        socketRef.current.emit(\"set playing team and player\", idRoom)\n\n        setDisplayStartGame(true)\n    }\n\n    return (\n        <>\n            { displayStartGame\n                ? <StartGame socketRef={socketRef} idRoom={idRoom} />\n\n                : <>\n                    <h5>Phase {round} fini !</h5>\n\n                    <div className=\"row justify-content-between mx-auto\" style={{ width: '80%'}}>\n                        {teams?.map((team, index) => {\n\n\n                            return <>\n                                    <div className=\"team-results col-md-3 grow\">\n                                        <h4>{team.name}</h4> \n                                        <p> {team.points} {team.points <= 1 ? 'point' : 'points'}</p> \n                                    </div>\n                                </>\n                        })}\n                    </div>                    \n\n                    { yourPlayingRef.current === true\n                        ? <button onClick={() => startNextRound()} className=\"mon-bouton mx-auto\">\n                            Phase suivante !\n                        </button>\n\n                        :''\n                    }\n                    \n                  </>\n\n            }\n            \n        </>\n    )\n}\n\nexport default NextRound\n"]},"metadata":{},"sourceType":"module"}