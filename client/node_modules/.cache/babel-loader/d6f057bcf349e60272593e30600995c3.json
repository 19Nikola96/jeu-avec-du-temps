{"ast":null,"code":"import _slicedToArray from\"/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import io from'socket.io-client';import{v4 as uuidv4}from'uuid';import Room from'./Room';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CreateJoinRoom=function CreateJoinRoom(){var emptyRoom={name:'',id:'',admin:{id:'',pseudo:'',admin:false,available:true,playing:false},teamPlayedCount:0};var _useState=useState(false),_useState2=_slicedToArray(_useState,2),displayJoin=_useState2[0],setDisplayJoin=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),displayCreate=_useState4[0],setDisplayCreate=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),displayRoom=_useState6[0],setDisplayRoom=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),allRooms=_useState8[0],setAllRooms=_useState8[1];// DISPLAY //\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),myPseudo=_useState10[0],setMyPseudo=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),myId=_useState12[0],setMyId=_useState12[1];var _useState13=useState(emptyRoom),_useState14=_slicedToArray(_useState13,2),roomData=_useState14[0],setRoomData=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),roomName=_useState16[0],setRoomName=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),roomIdCopy=_useState18[0],setRoomIdCopy=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),error=_useState20[0],setError=_useState20[1];var socketRef=useRef();useEffect(function(){socketRef.current=io.connect('/');socketRef.current.on(\"your id\",function(id){setMyId(id);});socketRef.current.on(\"available rooms\",function(rooms){setAllRooms(rooms);});socketRef.current.on(\"throw link error\",function(error){console.log('error');setError(error);});setMyPseudo(localStorage.getItem('myPseudo'));},[]);var dynamicDisplayJoin=function dynamicDisplayJoin(){setDisplayJoin(!displayJoin);setDisplayCreate(false);};var dynamicDisplayCreate=function dynamicDisplayCreate(){setDisplayCreate(!displayCreate);setDisplayJoin(false);};var handleSubmitCreate=function handleSubmitCreate(e){e.preventDefault();if(roomName!==''){var roomId=uuidv4();var room={name:roomName,id:roomId,admin:{id:myId,pseudo:myPseudo,admin:true,available:true,playing:false},teamPlayedCount:0};setRoomData(room);socketRef.current.emit(\"create room\",room);socketRef.current.emit(\"share room\",room);setDisplayRoom(true);}};var handleSubmitJoin=function handleSubmitJoin(e){e.preventDefault();if(roomIdCopy!==''){var joinObj={roomIdCopy:roomIdCopy,id:myId,pseudo:myPseudo,admin:false};socketRef.current.emit(\"join room\",joinObj);socketRef.current.on(\"share room\",function(room){setRoomData(room);});setDisplayRoom(true);}};return/*#__PURE__*/_jsx(_Fragment,{children:displayRoom?/*#__PURE__*/_jsx(Room,{roomData:roomData,error:error,socketRef:socketRef}):/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column mx-auto w-75 text-center grow\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Hello \",myPseudo]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return dynamicDisplayCreate();},className:\"mon-bouton mx-2\",children:\"Cr\\xE9er une room\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return dynamicDisplayJoin();},className:\"mon-bouton mx-2\",children:\"Rejoindre une room\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center mt-4\",children:[displayCreate?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitCreate,className:\"row grow\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setRoomName(e.target.value);},className:\"mon-input\",placeholder:\"Nom de la room\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{className:\"mon-bouton mx-3\",type:\"submit\",children:\"Go !\"})]}):'',displayJoin?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitJoin,className:\"row grow\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setRoomIdCopy(e.target.value);},className:\"mon-input\",placeholder:\"Lien de la room\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{className:\"mon-bouton mx-3\",type:\"submit\",children:\"Go !\"})]}):'']}),/*#__PURE__*/_jsx(\"ul\",{children:Object.keys(allRooms).map(function(id,index){return/*#__PURE__*/_jsx(\"li\",{className:\"text-light\",children:id},id+index);})})]})});};export default CreateJoinRoom;","map":{"version":3,"sources":["/Users/nikolamorice-gallier/Desktop/Projets/online-timesup/client/src/Components/CreateJoinRoom.tsx"],"names":["React","useState","useEffect","useRef","io","v4","uuidv4","Room","CreateJoinRoom","emptyRoom","name","id","admin","pseudo","available","playing","teamPlayedCount","displayJoin","setDisplayJoin","displayCreate","setDisplayCreate","displayRoom","setDisplayRoom","allRooms","setAllRooms","myPseudo","setMyPseudo","myId","setMyId","roomData","setRoomData","roomName","setRoomName","roomIdCopy","setRoomIdCopy","error","setError","socketRef","current","connect","on","rooms","console","log","localStorage","getItem","dynamicDisplayJoin","dynamicDisplayCreate","handleSubmitCreate","e","preventDefault","roomId","room","emit","handleSubmitJoin","joinObj","target","value","Object","keys","map","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\nimport io from 'socket.io-client'\nimport { v4 as uuidv4 } from 'uuid';\nimport Room from './Room';\nimport { DataRoomObjWithKey, RoomObj } from '../Types'\n\nconst CreateJoinRoom= () => {\n\n    const emptyRoom = { name: '',\n                        id: '',\n                        admin: { id: '', pseudo: '', admin: false, available: true, playing: false },\n                        teamPlayedCount: 0\n                    }\n\n    const [displayJoin, setDisplayJoin] = useState(false)\n    const [displayCreate, setDisplayCreate] = useState(false)\n    const [displayRoom, setDisplayRoom] = useState(false)\n    const [allRooms, setAllRooms] = useState<DataRoomObjWithKey>({})\n\n    // DISPLAY //\n    const [myPseudo, setMyPseudo] = useState<string | null>()\n    const [myId, setMyId] = useState<string | number>()\n    const [roomData, setRoomData] = useState<RoomObj>(emptyRoom)\n    const [roomName, setRoomName] = useState('')\n    const [roomIdCopy, setRoomIdCopy] = useState('')\n    const [error, setError] = useState<string>('')\n\n    const socketRef: React.MutableRefObject<any> = useRef()\n\n    useEffect(() => {\n        socketRef.current = io.connect('/')\n\n        socketRef.current.on(\"your id\", (id: string | number) => {\n            setMyId(id)\n        })    \n        \n        socketRef.current.on(\"available rooms\", (rooms: DataRoomObjWithKey) => {\n            setAllRooms(rooms)            \n        })   \n\n        socketRef.current.on(\"throw link error\", (error: string) => { \n            console.log('error');\n                       \n            setError(error)\n        })\n\n        setMyPseudo(localStorage.getItem('myPseudo'))\n    }, [])\n\n    const dynamicDisplayJoin = () => {\n        setDisplayJoin(!displayJoin)\n        setDisplayCreate(false)\n    }\n\n    const dynamicDisplayCreate = () => {\n        setDisplayCreate(!displayCreate)\n        setDisplayJoin(false)\n    }\n\n    const handleSubmitCreate = (e: React.ChangeEvent<HTMLFormElement>) => {\n        e.preventDefault()\n\n        if (roomName !== '') {\n            let roomId = uuidv4()\n\n            const room: RoomObj = {\n                name: roomName,\n                id: roomId,\n                admin: { id: myId, pseudo: myPseudo, admin: true, available: true, playing: false },\n                teamPlayedCount: 0\n            }\n\n            setRoomData(room)\n            \n            socketRef.current.emit(\"create room\", room)\n            socketRef.current.emit(\"share room\", room)\n            \n            setDisplayRoom(true)\n        }\n    }\n\n\n    const handleSubmitJoin = (e: React.ChangeEvent<HTMLFormElement>) => {\n        e.preventDefault()\n\n        if (roomIdCopy !== '') {\n\n            const joinObj = {\n                roomIdCopy, id: myId, pseudo: myPseudo, admin: false\n            }\n\n            socketRef.current.emit(\"join room\", joinObj)\n\n            socketRef.current.on(\"share room\", (room: RoomObj) => {                \n                setRoomData(room)\n            })\n            \n            setDisplayRoom(true)\n        }    \n    }\n\n    return (\n        <>\n            { displayRoom \n                ? <Room roomData={roomData} error={error} socketRef={socketRef}/> \n            \n                : <div className=\"d-flex flex-column mx-auto w-75 text-center grow\">\n                    <h2>Hello {myPseudo}</h2>\n                    <div className=\"d-flex justify-content-center mt-2\">\n                        <button onClick={() => dynamicDisplayCreate()} className=\"mon-bouton mx-2\">Créer une room</button>\n                        <button onClick={() => dynamicDisplayJoin()} className=\"mon-bouton mx-2\">Rejoindre une room</button>\n                    </div>\n                    <div className=\"d-flex justify-content-center mt-4\">\n                        { displayCreate\n                            ? <form onSubmit={handleSubmitCreate} className=\"row grow\">\n                                <input onChange={(e) => setRoomName(e.target.value)} className=\"mon-input\" placeholder=\"Nom de la room\" type=\"text\"/>\n                                <button className=\"mon-bouton mx-3\" type=\"submit\">Go !</button>\n                            </form> \n                        \n                            : ''\n                        }\n                        { displayJoin\n                            ? <form onSubmit={handleSubmitJoin} className=\"row grow\">\n                                <input onChange={(e) => setRoomIdCopy(e.target.value)} className=\"mon-input\" placeholder=\"Lien de la room\" type=\"text\"/>\n                                <button className=\"mon-bouton mx-3\" type=\"submit\">Go !</button>\n                            </form> \n                        \n                            : ''\n                        }                                                \n                    </div>\n                    <ul>\n                        {                        \n                            Object.keys(allRooms).map((id, index) => {\n                                return <li className=\"text-light\" key={id + index}>{id}</li> \n                            })                   \n                        }\n                    </ul>\n                  </div>\n            }  \n        </>\n\n        \n    )\n}\n\nexport default CreateJoinRoom\n"]},"metadata":{},"sourceType":"module"}